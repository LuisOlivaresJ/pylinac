image: python:3.9

pipelines:

  pull-requests:
    '**':
      - step:
          name: Set up Env
          caches:
            - pip
          script:
            - apt-get update
            - python -m venv venv
            - source venv/bin/activate
            - pip install -r requirements-dev.txt
          artifacts:
            - venv/**
      - parallel:
          - step:
              name: Run CBCT Tests
              script:
                - source venv/bin/activate
                - pytest tests_basic/test_cbct.py
          - step:
              name: Run Planar Imaging Tests
              script:
                - source venv/bin/activate
                - pytest tests_basic/test_planar_imaging.py

  branches:
    master:
      - step:
          name: Run Tests
          caches:
            - pip
          script:
            - apt-get update
            - pip install -r requirements-dev.txt
            - pytest
